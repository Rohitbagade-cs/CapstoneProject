<body>
<div class="dashboard">

  <!-- ================= HEADER ================= -->
  <header class="dashboard__header">
    <h2 class="dashboard__title">Deals Dashboard</h2>
    <button class="btn btn--logout" (click)="logout()">
      <div class="icon"></div>
      <div class="text">Logout</div>
    </button>
  </header>

  <!-- ================= CREATE / UPDATE DEAL ================= -->
  <section *ngIf="isAdmin || isAnalyst" class="card">
    <h3 class="card__title">
      {{ editingDealId ? 'Update Deal' : 'Create New Deal' }}
    </h3>

    <form class="form" (ngSubmit)="saveDeal()">

      <div class="form-group">
        <label>Company Name</label>
        <input
          type="text"
          [(ngModel)]="newDeal.companyName"
          name="companyName"
          required
          placeholder="Enter company name"
        />
      </div>

      <!-- üîê ADMIN ONLY -->
      <div class="form-group" *ngIf="isAdmin">
        <label>Deal Amount</label>
        <input
          type="number"
          [(ngModel)]="newDeal.dealAmount"
          name="dealAmount"
          placeholder="Enter deal amount"
        />
      </div>

      <div class="form-group">
        <label>Description</label>
        <input
          type="text"
          [(ngModel)]="newDeal.description"
          name="description"
          placeholder="Deal description"
        />
      </div>

      <div class="form-group">
        <label>Status</label>
        <select [(ngModel)]="newDeal.statusId" name="statusId">
          <option [value]="1">NEW</option>
          <option [value]="2">IN_REVIEW</option>
          <option [value]="3">APPROVED</option>
          <option [value]="4">REJECTED</option>
          <option [value]="5">CLOSED</option>
        </select>
      </div>

      <button class="btn btn--primary" type="submit">
        {{ editingDealId ? 'Update Deal' : 'Create Deal' }}
      </button>
    </form>
  </section>

  <!-- ================= DEALS LIST ================= -->
  <section class="card">
    <h3 class="card__title">Deals List</h3>

    <p *ngIf="!deals.length" class="empty-state">
      No deals available
    </p>

    <ul class="deal-list" *ngIf="deals.length">
      <li class="deal-item" *ngFor="let deal of deals">

        <div class="deal-item__header">
          <strong class="cname">{{ deal.companyName }}</strong>
          <span class="badge">{{ deal.status }}</span>
        </div>

        <div class="deal-item__body">
          <p *ngIf="isAdmin">
            <strong>Amount:</strong> ‚Çπ{{ deal.dealAmount }}
          </p>
          <p>
            <strong>Assigned To:</strong> {{ deal.assignedTo }}
          </p>
          <p>
            <strong>Description:</strong> {{ deal.description }}
          </p>
        </div>

        <div class="deal-item__actions">
          <button class="btn btn--secondary" (click)="editDeal(deal)">
            ‚úèÔ∏è Edit
          </button>

          <button
            *ngIf="isAdmin"
            class="btn btn--danger"
            (click)="deleteDeal(deal.id)"
          >
            üóëÔ∏è Delete
          </button>
        </div>

      </li>
    </ul>
  </section>

</div>
</body>